bind-key -n C-t new-window -c "#{pane_current_path}"
bind-key -n C-n next-window

bind-key -n C-\- split-window -c "#{pane_current_path}"
bind-key -n C-\\ split-window -h -c "#{pane_current_path}"

# Smart pane navigation: send Ctrl-hjkl to Neovim splits when focused,
# otherwise move between tmux panes.
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?nvim(.diff)?$'"
bind-key -n C-h if-shell "$is_vim" "send-keys C-h" "select-pane -L"
bind-key -n C-j if-shell "$is_vim" "send-keys C-j" "select-pane -D"
bind-key -n C-k if-shell "$is_vim" "send-keys C-k" "select-pane -U"
bind-key -n C-l if-shell "$is_vim" "send-keys C-l" "select-pane -R"
# auto-balance after any split
set-hook -g after-split-window "select-layout -E"
# rebalance when a pane closes (both killed or natural exit)
set-hook -g pane-died "select-layout -E"
set-hook -g pane-exited "select-layout -E"
set-hook -g after-kill-pane "select-layout -E"

set -g history-limit 100000

set -g mouse on

set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

bind r source-file ~/.tmux.conf

set -g status on
set -g status-interval 1
set -g status-position bottom
set -g status-justify centre

set -g status-left-length 50
set -g status-right-length 50

# Add breathing room between window tabs in the status bar
setw -g window-status-separator " "

# Detect macOS appearance and apply theme
if-shell 'defaults read -g AppleInterfaceStyle 2>/dev/null | grep -q Dark' \
  'source-file ~/.tmux.conf.nord-dark' \
  'source-file ~/.tmux.conf.solarized-light'

setw -g mode-keys vi

set -g default-shell /opt/homebrew/bin/fish
# set -g default-shell /usr/bin/fish

# Enable truecolor support to fix nvim colors
set -g default-terminal "xterm-256color"
set -ag terminal-overrides ",alacritty:RGB,xterm-256color:RGB"

# Automatically rename windows based on terminal title
set -g set-titles on
set -g set-titles-string "#T"
setw -g automatic-rename on
set -g automatic-rename-format "#T"
